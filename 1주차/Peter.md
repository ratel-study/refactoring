# Peter
리팩터링 스터디

---
## Ch.1 이해하기 힘든 이름

- "좋은 이름"은 깔끔한 코드의 중요한 요소
- 직관적인 이름이 좋은 이름
- 처음부터 좋은 이름을 짓기는 어렵다. 리팩토링에 익숙해지자


### 좋은 이름을 위한 리팩토링 기술

1. **함수 선언 변경하기**
   - 주석을 작성한 다음, 주석을 함수 이름으로 만들어 보기
   - 함수의 매개변수의 역할
     - 함수 내부의 문맥을 결정
       - 어느 수준의 정보를 전달하는지에 따라
     - 의존성 결정
     > IntelliJ 의 rename, change signature 활용
2. **변수 이름 바꾸기**
   1. 다이나믹 타입을 지원하는 언어에서는 타입을 이름에 포함하기도 함
3. **필드 이름 바꾸기**
   1. Record 자로 구조의 필드 이름은 프로그램 전반에 걸쳐 참조될 수 있기 때문에 매우 중요
   2. 파이썬의 Dictionary, C#의 Record, 자바는 14부터

---
## Ch.2 중복 코드

- 중복 코드의 단점
  - 코드가 비슷한지, 동일한지 확인하는 시간 소요
  - 코드 변경 포인트가 분산됨

### 중복 코드를 제거하는 리팩토링 기술

1. **함수 추출하기**
   - 동일한 코드를 여러 메소드에서 사용하는 경우
   - "의도"와 "구현" 분리하기
     - 무슨 일을 하는 코드인지 분석해야 하는 코드라면 함수로 분리하고 무슨 일을 하는지 이름으로 표현 가능
     - 의도를 잘 표현하기 위함이라면 한 줄짜리 메서드도 괜찮다
     - 거대한 메서드의 주석은 의도를 표현한 경우가 많다 = 함수 추출 포인트
2. **코드 분리하기**
    - 코드가 비슷하지만 완전히 동일하지 않은 경우
    - 관련있는 코드끼리 묶여있어야 코드 이해가 쉽다
      - 함수에서 사용할 변수 사용 직전에 선언하기
    - 코드 순서를 정리하여 동일한 코드 형태로 만들 수 있다
3. **메소드 올리기**
    - 여러 하위 클래스에 동일한 코드가 있는 경우
    - 비슷하지만 일부 값만 다른 경우 "함수 매개변수화하기" 적용 후 메소드 올리기 사용
    - 상위가 아닌 하위 클래스에 의존한다면 "필드 올리기" 적용 후 사용
    - 두 메소드가 비슷한 절차를 따르고 있다면, "템플릿 메소드 패턴"
    > IntelliJ - Pull members up


---
## Ch.3 긴 함수

- 짧은 함수 vs 긴 함수
- 함수가 길면 이해하기 어렵다 vs 짧은 함수는 문맥 전환이 잦다.
- 과거에는 작은 함수를 사용하는 경우 서브루틴 호출로 인한 오버헤드 있었음
- 작은 함수에 좋은 이름이 있다면 가독성이 올라간다.
- 주석을 남기고 싶다면, 함수를 만들고 의도를 표현해보자

### 긴 함수를 제거하는 리팩토링 기술
- 함수 추출하기로 99% 해결 가능
- 함수로 분리하면서 매개변수가 많아진다면,
  - 인스턴스 필드로 선언하는 법
  - **임시 변수를 질의 함수로 바꾸기**
    - 다른 변수를 가공한 값 등
  - **매개변수 객체 만들기**
    >  IntelliJ - Introduce parameter object
  - **객체 통째로 넘기기**
    - 적용할 때 의존성 고려해야
    - 해당 메소드 위치가 부적절 할지도(Ch. 9)
        >  IntelliJ - move instance method
- **함수를 명령으로 바꾸기** 커맨드 패턴
  - 함수를 독립적인 객체로 만들어 사용
  - undo 등 부가, 추가 기능을 위한 메서드 추가 가능
  - 상속, 템플릿 활용 가능
  - 복잡한 메소드 쪼개기 가능
- **조건문 분해하기**
  - 조건도 의도를 표현하고, 액션도 의도를 표현해야 한다.
  - 함수 추출하기로 의미를 부여하는 것.
- **조건문을 다형성으로 바꾸기**
  - 여러 타입에 따라 각기 다른 로직으로 처리해야 하는 경우 조건문을 명확하게 분리
  - 반복되는 switch 문을 각기 다른 클래스로
  - 공통 로직은 상위클래스에, 달라지는 부분만 강조
- **반복문 쪼개기**
  - 하나의 반복문에서 여러 다른 작업을 하는 코드 많음
  - 이런 반복문을 수정할 때 여러 작업을 고려해야함
  - 반복문을 쪼개면 이해가 쉽고, 수정도 쉬워진다.
  - 성능 문제가 생길 수 있지만, 리팩토링은 성능 최적화가 아니다.
  - 리팩토링 후 성능 최적화 시도 가능


---
## Ch.4 긴 매개변수 목록

- 매개변수가 많을수록 함수의 역할을 이해하기 여려워진다
  - 여러가지 일을 하고 있을 가능성이 높다
  - 불필요한 매개변수, 하나로 뭉칠 수 있는 매개변수들 없는지
- 매개변수에 값을 전달하는 것은 "호출하는 쪽"의 책임. 이 것은 줄이고 함수 내부에서 책임지도록

### 긴 매개변수 목록을 개선하는 리팩토링 기술

- 매개변수를 질의 함수로 바꾸기
- 객체 통째로 넘기기
- 매개변수 객체 만들기
- **플래그 인수 제거하기**
  - "조건문 분해하기" 활용
- **여러 함수를 클래스로 묶기**
  - 비슷한 매개변수 목록을 여러 함수에서 사용할 경우
  - 메소드를 모아서 클래스를 만들고 매개변수들을 필드로 선언
