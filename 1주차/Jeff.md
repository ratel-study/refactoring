# Jeff
리팩터링 스터디

---
# 챕터1 

## 이해하기 힘든 이름

### 함수 선언 변경하기

→ 함수의 이름 뿐 아니라

- 매개변수 추가,삭제, 시그니처 변경 등등을 포괄

→ 이름만 보고도 구현을 보지 않고도 이해 할 수 있어야 함

→ 좋은 이름을 찾는 방법?

함수의 주석을 작성한다음 → 주석을 통해서 함수 이름 생성

매개변수

- 함수 내부의 문맥 결정

  ex) 전화번호 포매팅 함수

  → 실제로 필요한 정보만(text형태) 넘기는 형식

- 의존성을 결정

  ex) Payment 만기일 계산 함수

  → due date만 넘길 것인지

  → Payment 에 대한 정보를 전부 넘길 것인지

  정책적인 의존성


### 변수 이름 바꾸기

많이 사용되는 변수일수록 이름이 더 중요

ex) 람다식에서 사용하는 변수 vs 함수의 매개변수

- 다이나믹 타입을 지원하는 경우에는 타입을 이름에 넣기도 함

### 필드 이름 바꾸기

- Record 자료 구조의 필드는 특히 매우 중요
    - Record
        - 특정 데이터와 관련있는 필드를 묶어놓은 자료 구조

## 중복코드

완전히 동일한 코드

비슷한 유형의 코드

- 완전히 동일한건지 비슷한지 보는데 리소스가 많이 듦
- 동일한 모든 곳의 코드 변경해야함

사용할 수 있는 리팩토링 기술

- 동일한 코드를 여러메서드에서 사용하는 경우
    - Extract Function
- 코드 비슷하지만 완벽하게 같지는 않은 경우
    - Slide Statements
        - Statements의 위치를 조정하면서 동일하게 맞춰가는 것
- 상속구조의 코드에서 하위클래스에 동일한 코드 있으면 메소드 상위로 올리기
    - Pull Up Method

### Extract Function

- “의도” , “구현” 분리하기
- 이 코드가 무슨일을 하려는지 파악을 할 수 있다면 → 의도가 분명한 코드

구현을 드러내는 것을 → 의도를 드러내도록 추출하여 작성(메서드 이름에 의미)

한줄짜리 메서드도 괜찮음 → 의도를 잘 들어낼 수 있다면

구현이 너무 구구절절 이라면 → 의도를 표현 할 수 있도록 변경 하는 것이 좋음

### Slide Statements

- 관련있는 코드끼리 묶는 것
- 변수는 사용되기 바로 직전에 선언되는 것이 좋음

### Pull Up Method

- 중복코드 잠재적인 버그를 유발 할 수 있음

  → 한 군데만 변경을 할 경우


비슷한 코드인데 절차가 동일하다

→ 템플릿 메서드 패턴

## 긴 함수

코드를 의미를 파악하는게 아니라 코드의 구현을 파악하는 느낌이 든다면

### 임시 변수를 질의 함수로 변경하기

> Replace Temp with Query
>

1. 임시 변수를 사용해서
    1. 동일한 식을 계산하는 것을 피하고
    2. 이름을 사용하여 의미를 표현
2. 빼낸 임시 변수를 함수로 전달해서 매개변수를 줄일 수 있음

ex) 예시로 totalNumberOfEvents 를 통해서 rate계산 해서 넘겨주던 부분을

totalNumberOfEvents 가 이미 있으니까 그 rate 계산해주는 부분을 따로 메서드 추출하고

그 메서드를 다시 호출하는 방법으로

→ 메서드 끼리 협력

### 매개변수 객체 만들기

> Introduce Parameter Object
>

같은 매개변수들이 여러 메서드에 걸쳐 나타난다면 매개변수 묶은 자료구조로 만들어서 넘기자

→ 묶음으로 구분되고 연관이 있다는 것을 의미하므로

- 도메인을 이해하는데 중요한 역할을 하는 클래스로 발전 할 수 있음

### 객체 통째로 넘기기

> Preserve Whole Object
>

매개변수 객체 넘기기와 비슷하지만

흐름이 역방향임 ( 이미 객체가 존재하는 경우임 )

- 의존성을 고려해야함.
- 불필요한 객체를 넘기면 안됨.

⇒ 해당 메서드의 위치가 적절하지 않을 수도 있음

→ 책임의 소재가 분명해야함

객체 통째로 넘기기를 고려한다는 것

→ 객체 내부의 모든 것을 활용해야한다는 것인데

그렇다면 추가로 필요한 것을 그 객체에 넘겨주고 스스로 값을 반환하도록 해야하는 것 아닌지

고려햐봐야한다는 의미

### 함수를 명령으로 바꾸기

> Replace Function with Command
>

함수를 독립적인 커맨드로 분리해내면

- 복잡도가 높아질 수 있으므로 주의
- 함수 추출을 먼저 하고서 더 복잡해질 것 같다면 분리하여 Command로 생성

→ undo 같은 메서드도 지원 할 수 있음

ex) 강의 예시에서 마크다운으로 내보내거나, csv 로 내보내거나 하는 동작

### 조건문 분해하기

> Decompose Conditional
>

조건문 여러개의 메서드로 분해해내는 과정 중 의미를 부여하는 방법

조건에 의미를 부여하거나

조건일 때 동작하는 코드들에 의미를 부여함

예시로

→ If 문에서 조건 의미 부여

→ 참인 경우 동작 의미 부여

→ 거짓인 경우 동작 의미 부여

### 반복문 쪼개기

> Split Loop
>

성능에 치명적이지 않다면 쪼개서 확인하는 방법도 고려

### 조건문을 다형성으로 바꾸기

> Replace Conditional with Polymorphism
>

→ 여러 타입에 따라 각기 다른 로직으로 처리해야 하는 경우

다형성을 적용해서 조건문을 보다 명확하게 분리 가능

- 공통되는 부분이 있고, 특정 부분에서만 변경이 되는 경우 사용 권장

동적으로 바뀌어야 한다면 → 결국엔 분기를 태울 수 밖에 없긴 함

예제로) 어떤 printer 를 선택할지 type을 주는 방식에서 상속받은 객체 사용하는 것

## 긴 매개변수 목록

- 매개변수가 많을수록 함수의 역할 이해하기 어려움
    - 불필요한 매개변수는 없나 ?
    - 하나의 레코드로 뭉칠 수 있는 매개변수 목록은 없나 ?

→ 매개변수가 많다? ⇒ 여러가지 일을 할 수도 있음

두번째 매개변수를 첫번째 매개변수로 추론할 수 있다면 중복이라고 볼 수 있음

### 매개변수를 질의 함수로 바꾸기

> Replace Parameter with Query
>

매개변수는 → 함수를 호출하는 클라이언트의 책임임

위에서 본 예시와 비슷한데

→ dicountLevel을 파라미터로 넘길 때 discountLevel을 가져오는 함수를 추출하고 해당 함수를 호출하는 방식으로 변경 가능

### 플래그 인수 제거하기

> Remove Falg Argument
>
- 보통 함수 내부의 로직을 분기하는 것에 사용됨

→ 차이를 파악하기 어려움

Flag 가 여러개가 있다 ?

→ 너무 많은 일을 한곳에서 한다.

Falg가 하나 존재해도

→ 클라이언트는 메서드가 하는 일의 의미를 파악하기가 어려움

### 여러 함수를 클래스로 묶기

> Combine Functions into Class
>
- 비슷한 매개변수 여러 함수에서 사용하면 → 해당 메서드 모아서 클래스 만들 수 있음
